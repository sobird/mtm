"use strict";(window.webpackJsonp_mtm_market=window.webpackJsonp_mtm_market||[]).push([[439],{3343:(Z,C,e)=>{e.d(C,{Z:()=>t});var u=e(5893),E=e(599),g=e.n(E),r=e(4184),j=e.n(r),l=e(4047),y=e.n(l),f=e(7484),p=e.n(f);const{RangePicker:R}=l.DatePicker,t=({text:d,mode:F,fieldProps:_,render:v,renderFormItem:A})=>{const{value:B=[],onChange:M,defaultValue:U}=_,L=[...B],[V,O]=L;O&&(L[1]=O?.map(a=>p()(a)));const[I,H]=(0,E.useState)(B[1]?2:1),[W,n]=(0,E.useState)(L);if(F==="read"){const a=(0,u.jsx)("span",{children:O?L[1].map(o=>o.format("YYYY-MM-DD")).join(" \u5230 "):`\u9886\u53D6\u540E ${V||"-"} \u5929`});return v?v(d,{mode:F,..._},a):a}if(F==="edit"||F==="update"){const a=m=>{H(m.target.value),o(m.target.value,W)},o=(m,P)=>{const c=[...P||[]],[,x]=c;x&&(c[1]=x?.map(S=>S.format("YYYY-MM-DD"))),m===1?c[1]=void 0:c[0]=void 0,M?.(c)},D=(m,P)=>{const c=[...W||[]];c[m]=P===null?void 0:P,n(c),o(I,c)},{className:s}=_,i=(0,u.jsxs)(l.Radio.Group,{className:j()("input-use-term",s),value:I,onChange:a,children:[(0,u.jsxs)(l.Radio,{value:1,children:[(0,u.jsx)("span",{children:"\u9886\u53D6\u540E"}),(0,u.jsx)(l.InputNumber,{style:{flex:1},addonAfter:"\u5929",min:1,max:30,value:W?.[0],defaultValue:U?.[0],onChange:m=>D(0,m)})]}),(0,u.jsxs)(l.Radio,{value:2,children:[(0,u.jsx)("span",{children:"\u81EA\u5B9A\u4E49"}),(0,u.jsx)(R,{style:{flex:1},value:W?.[1],defaultValue:U?.[1],onChange:m=>D(1,m)})]})]});return A?A(d,{mode:F,..._},i):i}}},1849:(Z,C,e)=>{e.d(C,{Z:()=>T});var u=e(5893),E=e(2975),g=e.n(E),r=e(4047),j=e.n(r),l=e(2979),y=e.n(l);const f=(0,E.createHashRouter)([{}]);function p(t,d,F,_){var v;let A=t.path;const B=F.indexOf(t)===F.length-1;return B?(0,u.jsx)("span",{children:t.title}):t.href?(0,u.jsx)("a",{href:f.createHref({pathname:t.href}),onClick:M=>{M.preventDefault(),f.navigate(t.href)},children:t.title}):(((v=t.path)==null?void 0:v.indexOf("/"))!==0&&(A="/"+_.filter(M=>M).join("/")),console.log("paths",JSON.stringify(_),A),B?(0,u.jsx)("span",{children:t.title}):(0,u.jsx)(E.Link,{to:A,relative:"route",children:t.title}))}const T=({children:t,breadcrumb:d,title:F,icon:_,description:v,extra:A,...B})=>(0,u.jsxs)("div",{className:"micro-page-container",...B,children:[(0,u.jsxs)("div",{className:"micro-page-header",children:[(0,u.jsx)(r.Breadcrumb,{className:"micro-breadcrumb",separator:(0,u.jsx)(l.RightOutlined,{}),itemRender:p,...d}),(0,u.jsxs)(r.Row,{className:"micro-page-header-heading",align:"middle",children:[(0,u.jsx)(r.Col,{flex:1,children:(0,u.jsxs)("h2",{children:[typeof _=="string"?(0,u.jsx)("i",{className:`iconfont icon-${_}`}):_,F]})}),(0,u.jsx)(r.Col,{children:(0,u.jsx)(r.Space,{children:A})})]}),v&&(0,u.jsx)("div",{className:"micro-page-header-description",children:v})]}),(0,u.jsx)(r.Card,{bodyStyle:{padding:16},className:"micor-page-content",children:t})]})},6785:(Z,C,e)=>{e.d(C,{Z:()=>W});var u=e(5893),E=e(2975),g=e(4047),r=e(9018),j=e(502);const l=(n,a)=>({fieldProps:D,proFieldProps:s,...i})=>(0,u.jsx)(j.Z,{valueType:a,render:(m,P,c)=>{const{mode:x}=P;return(0,u.jsx)(n,{text:m,mode:x,fieldProps:P})},renderFormItem:(m,P,c)=>{const{mode:x}=P;return(0,u.jsx)(n,{text:m,mode:x,fieldProps:P})},fieldProps:D,proFieldProps:s,...i});var y=e(599),f=e.n(y),p=e(4184),R=e.n(p),T=e(869),t=e(2077),d=e.n(t);const F={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"\u5343",million:"\u767E\u4E07",billion:"\u5341\u4EBF",trillion:"\u5146"},ordinal(){return"."},currency:{symbol:"\xA5"}};d().register("locale","zh",F),d().locale("zh"),d().nullFormat(""),d().fn.round=function(n=2){return Math.round(Math.pow(10,n)*this.value())/Math.pow(10,n)},d().fn.isFloat=function(){const n=this.value();return parseInt(n,10)<parseFloat(n)},d().register("format","custom formats",{regexps:{format:/(&)/,unformat:/(&)/},format(n,a,o){const D=d()._.includes(a," %")?" ":"";let s;return n*=100,a=a.replace(/\s?%/,""),s=d()._.numberToFormat(n,a,o),d()._.includes(s,")")?(s=s.split(""),s.splice(-1,0,`${D}%`),s=s.join("")):s=`${s}${D}%`,s},unformat(n){return d()._.stringToNumber(n)*.01}});const _=null,v=({text:n,mode:a,render:o,placeholder:D,renderFormItem:s,fieldProps:i},m)=>{const{value:P,defaultValue:c,onChange:x,id:S,validator:J=[]}=i,[G,uu]=(0,y.useState)([]),[K,Y]=(0,T.Z)(()=>c,{value:P,onChange:x});if(a==="read"){const $=(0,u.jsxs)("span",{ref:m,children:["\u6EE1 ",n[0]||"-","\u5143 \u51CF ",n[1]||"-","\u5143"]});return o?o(n,{mode:a,...i},$):$}if(a==="edit"||a==="update"){const $=()=>{if(Array.isArray(K)){const[h,N]=K;typeof h=="number"&&typeof N=="number"&&h>N?Y([N,h]):h===void 0&&N===void 0&&Y(void 0)}},Q=(h,N)=>{var q;const z=[...K||[]];z[h]=N===null?void 0:N,Y(z),G[h]={...(q=J[h])==null?void 0:q.call(J,z)},uu(G)},X=i?.placeholder||D||["\u8BF7\u8F93\u5165\u6EE1\u51CF\u95E8\u69DB","\u8BF7\u8F93\u5165\u4F18\u60E0\u91D1\u989D"],b=h=>Array.isArray(X)?X[h]:X,{className:eu,...w}=i,k=(0,u.jsxs)("div",{className:R()("input-amount-rule",eu),children:[(0,u.jsx)(g.InputNumber,{style:{width:"100%"},addonBefore:"\u6EE1",addonAfter:F.currency.symbol,min:0,max:5e3,...w,placeholder:b(0),id:`${S}-0`,value:K?.[0],defaultValue:c?.[0],onChange:h=>Q(0,h)}),(0,u.jsx)(g.InputNumber,{style:{width:"100%"},addonBefore:"\u51CF",addonAfter:F.currency.symbol,min:0,max:5e3,...w,placeholder:b(1),id:`${S}-1`,value:K?.[1],defaultValue:c?.[1],onChange:h=>Q(1,h)})]});return s?s(n,{mode:a,...i},k):k}return null},A=async(n,a)=>{const[o,D]=a;if(!o&&o!==0)throw new Error("\u8BF7\u8F93\u5165\u6EE1\u51CF\u95E8\u69DB");if(!D&&D!==0)throw new Error("\u8BF7\u8F93\u5165\u4F18\u60E0\u91D1\u989D")},B=[n=>{const[a,o]=n;if(!a&&a!==0)return{status:"error",help:"\u8BF7\u8F93\u5165\u6EE1\u51CF\u95E8\u69DB"}},n=>{const[a,o]=n;if(!o&&o!==0)return{status:"error",help:"\u8BF7\u8F93\u5165\u4F18\u60E0\u91D1\u989D"};if(o<.01)return{status:"error",help:"\u9762\u989D\u6700\u5C0F\u503C\u662F0.01\u5143"};if(a===0){if(o>500)return{status:"error",help:"\u95E8\u69DB\u4E3A0\u65F6\uFF0C\u9762\u989D\u9700\u5C0F\u4E8E\u7B49\u4E8E500\u5143"};o>10}}],M=f().forwardRef(v),U=l(M,"AmountRule");var L=e(3343);const V=l(L.Z,"UseTerm");var O=e(2655);const I={labelCol:{flex:"0 0 110px"}},W=({children:n,mode:a,...o})=>{const[,D]=(0,E.useSearchParams)();return(0,u.jsxs)(r.ProForm,{colon:!1,layout:"horizontal",...I,submitter:{render:(s,i)=>(0,u.jsx)(g.Space,{style:{marginLeft:110},children:i})},...o,children:[(0,u.jsx)(r.ProFormSelect,{name:"target",label:"\u4F18\u60E0\u5238\u7C7B\u578B",valueEnum:O.Qi,placeholder:"\u8BF7\u9009\u62E9",width:"lg",allowClear:!1,disabled:a&&a==="update",onChange:s=>{D(i=>(i.set("target",s),i),{replace:!0})}}),(0,u.jsx)(r.ProFormText,{width:"lg",name:"name",label:"\u4F18\u60E0\u5238\u540D\u79F0",placeholder:"\u8BF7\u586B\u5199\u4F18\u60E0\u5238\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u4F18\u60E0\u5238\u540D\u79F0"},{max:10,message:"\u4F18\u60E0\u5238\u540D\u79F0\u6700\u591A\u586B\u519910\u4E2A\u5B57"}]}),(0,u.jsx)(r.ProFormText,{name:"displayName",label:"\u4F18\u60E0\u5238\u6587\u6848",disabled:!0,width:"lg"}),(0,u.jsx)(r.ProFormDateTimeRangePicker,{required:!0,width:"lg",name:"putTerm",label:"\u53D1\u653E\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u53D1\u653E\u65F6\u95F4"}]}),(0,u.jsx)(r.ProFormDigit,{label:"\u53D1\u653E\u5F20\u6570",name:"stock",placeholder:"\u8BF7\u8F93\u51651-1,000,000\u7684\u6B63\u6574\u6570",width:"lg",min:1,max:1e6,rules:[{required:!0,message:"\u8BF7\u586B\u5199\u53D1\u653E\u5F20\u6570"}]}),(0,u.jsx)(U,{fieldProps:{validator:B},placeholder:["\u8BF7\u8F93\u5165\u95E8\u69DB","\u8BF7\u8F93\u5165\u9762\u989D"],name:"rule",label:"\u95E8\u69DB\u53CA\u9762\u989D",width:"lg",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u95E8\u69DB\u53CA\u9762\u989D"}]}),(0,u.jsx)(r.ProFormSelect,{name:"limit",label:"\u6BCF\u4EBA\u9650\u9886\u5F20\u6570",valueEnum:O.U8,placeholder:"\u8BF7\u9009\u62E9",width:"lg",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6BCF\u4EBA\u9650\u9886\u5F20\u6570"}]}),(0,u.jsx)(V,{name:"useTerm",label:"\u4F7F\u7528\u65F6\u95F4",width:"lg",required:!0}),n]})}},439:(Z,C,e)=>{e.r(C),e.d(C,{default:()=>_});var u=e(5893),E=e(599),g=e.n(E),r=e(2975),j=e.n(r),l=e(4047),y=e.n(l),f=e(9018),p=e.n(f),R=e(1849),T=e(6785),t=e(2655);const d=[{title:"\u9996\u9875",href:"/"},{title:"\u8425\u9500\u4E2D\u5FC3",path:"/"},{title:"\u4F18\u60E0\u5238",path:"coupons"},{title:"\u7F16\u8F91\u4F18\u60E0\u5238",path:"update"}],_=()=>{const v=(0,r.useNavigate)(),A=(0,r.useParams)(),[B]=l.Form.useForm(),[M,U]=l.message.useMessage(),[L,V]=(0,E.useState)();(0,E.useEffect)(()=>{t.ZP.detail(A.id).then(I=>{V(I),setTimeout(()=>{B.resetFields()},0)})},[]);const O=async I=>{t.ZP.update(I).then(()=>{M.success("\u66F4\u65B0\u4F18\u60E0\u5238\u6210\u529F",1,()=>{v(-1)})})};return(0,u.jsxs)(R.Z,{breadcrumb:{items:d},title:"\u7F16\u8F91\u4F18\u60E0\u5238",extra:[(0,u.jsx)(l.Button,{onClick:()=>v(-1),children:"\u8FD4\u56DE"})],children:[U,(0,u.jsx)("div",{className:"page-coupon-detail",children:(0,u.jsx)(T.Z,{form:B,initialValues:L,onFinish:O,mode:"update",children:(0,u.jsx)(f.ProFormText,{hidden:!0,label:"\u4F18\u60E0\u5238ID",width:"lg",name:"id"})})})]})}},2655:(Z,C,e)=>{e.d(C,{Qi:()=>r,Ry:()=>y,U8:()=>f,Wb:()=>E,Xx:()=>g,ZP:()=>T,jS:()=>l,mi:()=>R,mu:()=>j});var u=e(8892);const E=new Map([[0,"\u6EE1\u51CF\u5238"],[1,"\u6298\u6263\u5238"]]);var g=(t=>(t[t.\u5E97\u94FA\u5546\u54C1\u5238=1]="\u5E97\u94FA\u5546\u54C1\u5238",t[t.\u5E97\u94FA\u901A\u7528\u5238=2]="\u5E97\u94FA\u901A\u7528\u5238",t[t.\u5E97\u94FA\u5BA2\u670D\u4F53\u9A8C\u5238=3]="\u5E97\u94FA\u5BA2\u670D\u4F53\u9A8C\u5238",t))(g||{});const r=new Map([[1,"\u5E97\u94FA\u5546\u54C1\u5238"],[2,"\u5E97\u94FA\u901A\u7528\u5238"],[3,"\u5E97\u94FA\u5BA2\u670D\u4F53\u9A8C\u5238"]]);var j=(t=>(t[t.\u5168\u90E8=-1]="\u5168\u90E8",t[t.\u672A\u5F00\u59CB=0]="\u672A\u5F00\u59CB",t[t.\u8FDB\u884C\u4E2D=1]="\u8FDB\u884C\u4E2D",t[t.\u5DF2\u7ED3\u675F=2]="\u5DF2\u7ED3\u675F",t[t.\u5DF2\u4E0B\u7EBF=6]="\u5DF2\u4E0B\u7EBF",t))(j||{});const l=new Map([[-1,"\u5168\u90E8"],[0,"\u672A\u5F00\u59CB"],[1,"\u8FDB\u884C\u4E2D"],[2,"\u5DF2\u7ED3\u675F"],[6,"\u5DF2\u4E0B\u7EBF"]]),y=new Map([[-1,""],[0,"gray"],[1,"green"],[2,"blue"],[6,"red"]]),f=new Map([[1,"1\u5F20"],[2,"2\u5F20"],[3,"3\u5F20"],[4,"\u4E0D\u9650"]]),p={async list(t){return u.ZP.get("/merchant/coupons",t)},detail(t){return u.ZP.get("/merchant/coupons",{id:t})},delete(t){return u.ZP.delete("/merchant/coupons",{id:t})},create(t){return u.ZP.post("/merchant/coupons",t)},update(t){return u.ZP.patch("/merchant/coupons",t)}},R=(t=10)=>t<2,T=p}}]);
