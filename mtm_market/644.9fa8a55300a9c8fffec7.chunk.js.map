{"version":3,"file":"644.9fa8a55300a9c8fffec7.chunk.js","mappings":"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","sources":["webpack:///./src/pages/coupon/index.tsx","webpack:///./src/services/coupon.ts"],"sourcesContent":["/**\n * 商家端优惠券列表\n * \n * sobird<i@sobird.me> at 2023/09/15 21:14:09 created.\n */\n\nimport React, { useEffect, useState } from \"react\";\nimport { Button, Table, Tag, Popconfirm } from 'antd';\nimport { Link } from 'react-router-dom';\nimport CouponService, { ICouponEntity, ICouponPagination, ECouponType, ECouponTarget, ECouponStatus, ECouponStatusColor } from \"@/services/coupon\";\nconst { Column, ColumnGroup } = Table;\n\nimport './index.scss';\n\nconst Coupons: React.FC = () => {\n  const [couponPagination, setCouponPagination] = useState<ICouponPagination>();\n\n  useEffect(() => {\n    CouponService.list().then(res => {\n      setCouponPagination(res);\n    })\n  }, []);\n  return (\n    <div className=\"page-coupons\">\n      \n      <Table dataSource={couponPagination?.list} rowKey=\"id\"\n        pagination={{\n          total: couponPagination?.total,\n          current: 2,\n          pageSize: 10\n        }}>\n        <Column title=\"优惠券编码\" dataIndex=\"id\" />\n        <Column title=\"优惠券名称\" dataIndex=\"name\" />\n        <Column \n          title=\"优惠类型\" \n          dataIndex=\"type\" \n          render={(text) => {\n            return ECouponType[text];\n          }}\n        />\n        <Column \n          title=\"券类型\" \n          dataIndex=\"target\" \n          render={(text) => {\n            return ECouponTarget[text];\n          }}\n        />\n        <Column title=\"发放时间\" dataIndex=\"stime\" />\n        <Column title=\"使用时间\" dataIndex=\"validDays\" />\n        <Column title=\"发放数量\" dataIndex=\"sendCount\" />\n        <Column title=\"当前余量\" dataIndex=\"leftCount\" />\n        <Column title=\"创建时间\" dataIndex=\"ctime\" />\n        <Column \n          title=\"状态\" dataIndex=\"status\" \n          render={(text) => {\n            return <Tag color={ECouponStatusColor[text]}>{ECouponStatus[text]}</Tag>;\n          }} />\n        <Column<ICouponEntity> \n          title=\"操作\" \n          dataIndex=\"status\" \n          render={(text, record) => {\n            return (\n              <>\n                <Link to={`/market/coupons/${record.id}`}>查看</Link>\n                { text < 2 && <Button type=\"link\" size=\"small\">编辑</Button>}\n                { text < 2 && <Popconfirm\n                  title=\"您确定要下线该优惠券吗？\"\n                  onConfirm={() => {\n                    CouponService.delete(record.id);\n                  }}\n                  okText=\"确定\"\n                  cancelText=\"取消\">\n                  <Button type=\"link\" size=\"small\">下线</Button>\n                </Popconfirm>}\n              </>\n            );\n          }} />\n      </Table>\n    </div>\n  )\n};\n\nexport default Coupons;\n","/**\n * 优惠券服务\n * \n * sobird<i@sobird.me> at 2023/09/15 21:58:06 created.\n */\n\nimport http from \"@mtm/shared/utils/http\";\n\ninterface ISpu {\n  /** SPU ID */\n  id: number;\n  /** SPU名称 */\n  name: string;\n  /** SPU状态; 0:已下架, 1:已上架 */\n  status: number;\n  /** 库存 */\n  stock: number;\n  /** 最低价 */\n  minPrice: number;\n  /** 当前SPU下的SKU数量 */\n  skuCount: number;\n}\n\nexport interface ICouponEntity {\n  /** 优惠券ID */\n  id: number;\n  /** 优惠券名称 */\n  name: string;\n  /** 优惠券文案 */\n  displayName: string;\n  /** 优惠券类型; 0:满减券, 1:折扣券 */\n  type: 0 | 1;\n  /** 发放时间段 */\n  putTerm: {\n    /** 优惠券发放开始日期 */\n    stime: number;\n    /** 优惠券发放结束日期 */\n    etime: number;\n  },\n  amountRule: {\n    amount: number;\n    discount: number;\n  },\n  /** 优惠券库存 */\n  stock: number;\n  /** 优惠券门槛 单位: 元 */\n  price: number;\n  /** 优惠券面额 单位: 元 */\n  discount: number;\n  /** 每人限领张数 */\n  limitCount: number;\n  /** \n   * 使用期限 单位: 天\n   * \n   * 先判断useTerm[0]的值，该值 >0 认为 是券领取X天内有效;\n   * 该值<=0 或 false，认为是在useTerm[1]到useTerm[2]期间券可以进行使用\n   */\n  useTerm: {\n    /** 优惠券领取X天内有效 */\n    periodDay: number;\n    stime: number;\n    etime: number;\n  };\n  /** 发券目标 */\n  target: 11 | 12;\n  /** 投放目标人群 -1:全部用户 新老客, 1:老客, 2:新老客 */\n  putTarget: -1 | 1 | 2;\n  /** 使用人群 */\n  useTarget: -1 | 1 | 2;\n  /** 投放位置 */\n  position: number;\n  /** 使用范围 */\n  useScope: string;\n  /** 发放数量 */\n  sendCount: number;\n  /** 当前余量 */\n  leftCount: number;\n  /** 优惠券状态; 未开始:0, 已开始(进行中):1, 已结束:2, 已撤销(已下线):6 */\n  status: 0 | 1 | 2 | 6;\n  /** 创建时间 时间戳 */\n  ctime: number;\n  /** 优惠券商品列表 */\n  spuList: ISpu[];\n  /** SPU ID 列表 */\n  spuIds: [];\n  /** 商家ID列表 */\n  wmPoiIds: number[]\n}\n\nexport interface ICouponPagination {\n  ps?: number;\n  pn?: number;\n  total: number;\n  list: ICouponEntity[]\n}\n\nexport enum ECouponType {\n  \"满减券\" = 0,\n  \"折扣券\" = 1\n}\n\nexport enum ECouponTarget {\n  \"店铺通用券\" = 11,\n  \"店铺客服体验券\" = 12\n}\n\nexport enum ECouponStatus {\n  \"全部\" = -1,\n  \"未开始\" = 0,\n  \"进行中\" = 1,\n  \"已结束\" = 2,\n  \"已下线\" = 6\n}\n\nexport const CouponStatusOption = [\n  { value: -1, label: \"全部\"},\n  { value: 0, label: \"未开始\"},\n  { value: 1, label: \"进行中\"},\n  { value: 2, label: \"已结束\"},\n  { value: 6, label: \"已下线\"}\n];\n\nexport enum ECouponStatusColor {\n  \"gray\" = 0,\n  \"green\" = 1,\n  \"blue\" = 2,\n  \"red\" = 6\n}\n\nexport interface ICouponsParams {\n  ps?: number;\n  pn?: number;\n  status?: number;\n  stime?: number;\n  etime?: number;\n}\n\nconst CouponService = {\n  list(params?: ICouponsParams) {\n    return http.get<ICouponPagination>('/merchant/coupons', params);\n  },\n  detail(id: number) {\n    return http.get<ICouponEntity>('/merchant/coupons', { id });\n  },\n  delete(id: number) {\n    return http.delete<ICouponEntity>('/merchant/coupons', { id });\n  },\n  create(data: ICouponEntity) {\n    return http.post<ICouponEntity>('/merchant/coupons', data);\n  },\n  update(data: ICouponEntity) {\n    return http.patch<ICouponEntity>('/merchant/coupons', data);\n  }\n}\n\nexport default CouponService;\n"],"names":["Column","ColumnGroup","couponPagination","setCouponPagination","res","text","record","ECouponType","ECouponTarget","ECouponStatus","CouponStatusOption","ECouponStatusColor","params","id","data"],"sourceRoot":""}