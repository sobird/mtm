"use strict";(window.webpackJsonp_mtm_market=window.webpackJsonp_mtm_market||[]).push([[741],{3343:(V,M,e)=>{e.d(M,{Z:()=>t});var u=e(5893),F=e(599),x=e.n(F),r=e(4184),j=e.n(r),m=e(4047),R=e.n(m),f=e(7484),g=e.n(f);const{RangePicker:y}=m.DatePicker,t=({text:l,mode:d,fieldProps:_,render:v,renderFormItem:A})=>{const{value:C=[],onChange:B,defaultValue:T}=_,U=[...C],[N,I]=U;I&&(U[1]=I?.map(a=>g()(a)));const[Z,H]=(0,F.useState)(C[1]?2:1),[L,n]=(0,F.useState)(U);if(d==="read"){const a=(0,u.jsx)("span",{children:I?U[1].map(o=>o.format("YYYY-MM-DD")).join(" \u5230 "):`\u9886\u53D6\u540E ${N||"-"} \u5929`});return v?v(l,{mode:d,..._},a):a}if(d==="edit"||d==="update"){const a=E=>{H(E.target.value),o(E.target.value,L)},o=(E,P)=>{const c=[...P||[]],[,O]=c;O&&(c[1]=O?.map(S=>S.format("YYYY-MM-DD"))),E===1?c[1]=void 0:c[0]=void 0,B?.(c)},D=(E,P)=>{const c=[...L||[]];c[E]=P===null?void 0:P,n(c),o(Z,c)},{className:s}=_,i=(0,u.jsxs)(m.Radio.Group,{className:j()("input-use-term",s),value:Z,onChange:a,children:[(0,u.jsxs)(m.Radio,{value:1,children:[(0,u.jsx)("span",{children:"\u9886\u53D6\u540E"}),(0,u.jsx)(m.InputNumber,{style:{flex:1},addonAfter:"\u5929",min:1,max:30,value:L?.[0],defaultValue:T?.[0],onChange:E=>D(0,E)})]}),(0,u.jsxs)(m.Radio,{value:2,children:[(0,u.jsx)("span",{children:"\u81EA\u5B9A\u4E49"}),(0,u.jsx)(y,{style:{flex:1},value:L?.[1],defaultValue:T?.[1],onChange:E=>D(1,E)})]})]});return A?A(l,{mode:d,..._},i):i}}},1849:(V,M,e)=>{e.d(M,{Z:()=>p});var u=e(5893),F=e(2975),x=e.n(F),r=e(4047),j=e.n(r),m=e(2979),R=e.n(m);const f=(0,F.createHashRouter)([{}]);function g(t,l,d,_){var v;let A=t.path;const C=d.indexOf(t)===d.length-1;return C?(0,u.jsx)("span",{children:t.title}):t.href?(0,u.jsx)("a",{href:f.createHref({pathname:t.href}),onClick:B=>{B.preventDefault(),f.navigate(t.href)},children:t.title}):(((v=t.path)==null?void 0:v.indexOf("/"))!==0&&(A="/"+_.filter(B=>B).join("/")),console.log("paths",JSON.stringify(_),A),C?(0,u.jsx)("span",{children:t.title}):(0,u.jsx)(F.Link,{to:A,relative:"route",children:t.title}))}const p=({children:t,breadcrumb:l,title:d,icon:_,description:v,extra:A,...C})=>(0,u.jsxs)("div",{className:"micro-page-container",...C,children:[(0,u.jsxs)("div",{className:"micro-page-header",children:[(0,u.jsx)(r.Breadcrumb,{className:"micro-breadcrumb",separator:(0,u.jsx)(m.RightOutlined,{}),itemRender:g,...l}),(0,u.jsxs)(r.Row,{className:"micro-page-header-heading",align:"middle",children:[(0,u.jsx)(r.Col,{flex:1,children:(0,u.jsxs)("h2",{children:[typeof _=="string"?(0,u.jsx)("i",{className:`iconfont icon-${_}`}):_,d]})}),(0,u.jsx)(r.Col,{children:(0,u.jsx)(r.Space,{children:A})})]}),v&&(0,u.jsx)("div",{className:"micro-page-header-description",children:v})]}),(0,u.jsx)(r.Card,{bodyStyle:{padding:16},className:"micor-page-content",children:t})]})},6785:(V,M,e)=>{e.d(M,{Z:()=>L});var u=e(5893),F=e(2975),x=e(4047),r=e(9018),j=e(502);const m=(n,a)=>({fieldProps:D,proFieldProps:s,...i})=>(0,u.jsx)(j.Z,{valueType:a,render:(E,P,c)=>{const{mode:O}=P;return(0,u.jsx)(n,{text:E,mode:O,fieldProps:P})},renderFormItem:(E,P,c)=>{const{mode:O}=P;return(0,u.jsx)(n,{text:E,mode:O,fieldProps:P})},fieldProps:D,proFieldProps:s,...i});var R=e(599),f=e.n(R),g=e(4184),y=e.n(g),p=e(869),t=e(2077),l=e.n(t);const d={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"\u5343",million:"\u767E\u4E07",billion:"\u5341\u4EBF",trillion:"\u5146"},ordinal(){return"."},currency:{symbol:"\xA5"}};l().register("locale","zh",d),l().locale("zh"),l().nullFormat(""),l().fn.round=function(n=2){return Math.round(Math.pow(10,n)*this.value())/Math.pow(10,n)},l().fn.isFloat=function(){const n=this.value();return parseInt(n,10)<parseFloat(n)},l().register("format","custom formats",{regexps:{format:/(&)/,unformat:/(&)/},format(n,a,o){const D=l()._.includes(a," %")?" ":"";let s;return n*=100,a=a.replace(/\s?%/,""),s=l()._.numberToFormat(n,a,o),l()._.includes(s,")")?(s=s.split(""),s.splice(-1,0,`${D}%`),s=s.join("")):s=`${s}${D}%`,s},unformat(n){return l()._.stringToNumber(n)*.01}});const _=null,v=({text:n,mode:a,render:o,placeholder:D,renderFormItem:s,fieldProps:i},E)=>{const{value:P,defaultValue:c,onChange:O,id:S,validator:J=[]}=i,[G,uu]=(0,R.useState)([]),[W,Y]=(0,p.Z)(()=>c,{value:P,onChange:O});if(a==="read"){const $=(0,u.jsxs)("span",{ref:E,children:["\u6EE1 ",n[0]||"-","\u5143 \u51CF ",n[1]||"-","\u5143"]});return o?o(n,{mode:a,...i},$):$}if(a==="edit"||a==="update"){const $=()=>{if(Array.isArray(W)){const[h,K]=W;typeof h=="number"&&typeof K=="number"&&h>K?Y([K,h]):h===void 0&&K===void 0&&Y(void 0)}},Q=(h,K)=>{var q;const z=[...W||[]];z[h]=K===null?void 0:K,Y(z),G[h]={...(q=J[h])==null?void 0:q.call(J,z)},uu(G)},X=i?.placeholder||D||["\u8BF7\u8F93\u5165\u6EE1\u51CF\u95E8\u69DB","\u8BF7\u8F93\u5165\u4F18\u60E0\u91D1\u989D"],b=h=>Array.isArray(X)?X[h]:X,{className:eu,...w}=i,k=(0,u.jsxs)("div",{className:y()("input-amount-rule",eu),children:[(0,u.jsx)(x.InputNumber,{style:{width:"100%"},addonBefore:"\u6EE1",addonAfter:d.currency.symbol,min:0,max:5e3,...w,placeholder:b(0),id:`${S}-0`,value:W?.[0],defaultValue:c?.[0],onChange:h=>Q(0,h)}),(0,u.jsx)(x.InputNumber,{style:{width:"100%"},addonBefore:"\u51CF",addonAfter:d.currency.symbol,min:0,max:5e3,...w,placeholder:b(1),id:`${S}-1`,value:W?.[1],defaultValue:c?.[1],onChange:h=>Q(1,h)})]});return s?s(n,{mode:a,...i},k):k}return null},A=async(n,a)=>{const[o,D]=a;if(!o&&o!==0)throw new Error("\u8BF7\u8F93\u5165\u6EE1\u51CF\u95E8\u69DB");if(!D&&D!==0)throw new Error("\u8BF7\u8F93\u5165\u4F18\u60E0\u91D1\u989D")},C=[n=>{const[a,o]=n;if(!a&&a!==0)return{status:"error",help:"\u8BF7\u8F93\u5165\u6EE1\u51CF\u95E8\u69DB"}},n=>{const[a,o]=n;if(!o&&o!==0)return{status:"error",help:"\u8BF7\u8F93\u5165\u4F18\u60E0\u91D1\u989D"};if(o<.01)return{status:"error",help:"\u9762\u989D\u6700\u5C0F\u503C\u662F0.01\u5143"};if(a===0){if(o>500)return{status:"error",help:"\u95E8\u69DB\u4E3A0\u65F6\uFF0C\u9762\u989D\u9700\u5C0F\u4E8E\u7B49\u4E8E500\u5143"};o>10}}],B=f().forwardRef(v),T=m(B,"AmountRule");var U=e(3343);const N=m(U.Z,"UseTerm");var I=e(2655);const Z={labelCol:{flex:"0 0 110px"}},L=({children:n,mode:a,...o})=>{const[,D]=(0,F.useSearchParams)();return(0,u.jsxs)(r.ProForm,{colon:!1,layout:"horizontal",...Z,submitter:{render:(s,i)=>(0,u.jsx)(x.Space,{style:{marginLeft:110},children:i})},...o,children:[(0,u.jsx)(r.ProFormSelect,{name:"target",label:"\u4F18\u60E0\u5238\u7C7B\u578B",valueEnum:I.Qi,placeholder:"\u8BF7\u9009\u62E9",width:"lg",allowClear:!1,disabled:a&&a==="update",onChange:s=>{D(i=>(i.set("target",s),i),{replace:!0})}}),(0,u.jsx)(r.ProFormText,{width:"lg",name:"name",label:"\u4F18\u60E0\u5238\u540D\u79F0",placeholder:"\u8BF7\u586B\u5199\u4F18\u60E0\u5238\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u4F18\u60E0\u5238\u540D\u79F0"},{max:10,message:"\u4F18\u60E0\u5238\u540D\u79F0\u6700\u591A\u586B\u519910\u4E2A\u5B57"}]}),(0,u.jsx)(r.ProFormText,{name:"displayName",label:"\u4F18\u60E0\u5238\u6587\u6848",disabled:!0,width:"lg"}),(0,u.jsx)(r.ProFormDateTimeRangePicker,{required:!0,width:"lg",name:"putTerm",label:"\u53D1\u653E\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u53D1\u653E\u65F6\u95F4"}]}),(0,u.jsx)(r.ProFormDigit,{label:"\u53D1\u653E\u5F20\u6570",name:"stock",placeholder:"\u8BF7\u8F93\u51651-1,000,000\u7684\u6B63\u6574\u6570",width:"lg",min:1,max:1e6,rules:[{required:!0,message:"\u8BF7\u586B\u5199\u53D1\u653E\u5F20\u6570"}]}),(0,u.jsx)(T,{fieldProps:{validator:C},placeholder:["\u8BF7\u8F93\u5165\u95E8\u69DB","\u8BF7\u8F93\u5165\u9762\u989D"],name:"rule",label:"\u95E8\u69DB\u53CA\u9762\u989D",width:"lg",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u95E8\u69DB\u53CA\u9762\u989D"}]}),(0,u.jsx)(r.ProFormSelect,{name:"limit",label:"\u6BCF\u4EBA\u9650\u9886\u5F20\u6570",valueEnum:I.U8,placeholder:"\u8BF7\u9009\u62E9",width:"lg",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6BCF\u4EBA\u9650\u9886\u5F20\u6570"}]}),(0,u.jsx)(N,{name:"useTerm",label:"\u4F7F\u7528\u65F6\u95F4",width:"lg",required:!0}),n]})}},8741:(V,M,e)=>{e.r(M),e.d(M,{default:()=>l});var u=e(5893),F=e(2975),x=e.n(F),r=e(4047),j=e.n(r),m=e(1849),R=e(6785),f=e(2655),g=e(599),y=e.n(g);const p=[{title:"\u9996\u9875",href:"/"},{title:"\u8425\u9500\u4E2D\u5FC3",path:"/"},{title:"\u4F18\u60E0\u5238",path:"coupons"},{title:"\u521B\u5EFA\u4F18\u60E0\u5238",path:"create"}],l=()=>{const d=(0,F.useNavigate)(),[_]=r.Form.useForm(),[v,A]=r.message.useMessage(),[C]=(0,F.useSearchParams)(),B=C.get("target")||1,T={target:Number(B),displayName:"xx "+f.Xx[B]};(0,g.useEffect)(()=>{_.resetFields()},[B]);const U=async N=>{f.ZP.create(N).then(()=>{v.success("\u521B\u5EFA\u4F18\u60E0\u5238\u6210\u529F",1,()=>{d(-1)})})};return(0,u.jsxs)(m.Z,{breadcrumb:{items:p},title:"\u521B\u5EFA\u4F18\u60E0\u5238",extra:[(0,u.jsx)(r.Button,{onClick:()=>d(-1),children:"\u8FD4\u56DE"})],children:[A,(0,u.jsx)("div",{className:"coupon-create-page",children:(0,u.jsx)(R.Z,{form:_,initialValues:T,onFinish:U})})]})}},2655:(V,M,e)=>{e.d(M,{Qi:()=>r,Ry:()=>R,U8:()=>f,Wb:()=>F,Xx:()=>x,ZP:()=>p,jS:()=>m,mi:()=>y,mu:()=>j});var u=e(8892);const F=new Map([[0,"\u6EE1\u51CF\u5238"],[1,"\u6298\u6263\u5238"]]);var x=(t=>(t[t.\u5E97\u94FA\u5546\u54C1\u5238=1]="\u5E97\u94FA\u5546\u54C1\u5238",t[t.\u5E97\u94FA\u901A\u7528\u5238=2]="\u5E97\u94FA\u901A\u7528\u5238",t[t.\u5E97\u94FA\u5BA2\u670D\u4F53\u9A8C\u5238=3]="\u5E97\u94FA\u5BA2\u670D\u4F53\u9A8C\u5238",t))(x||{});const r=new Map([[1,"\u5E97\u94FA\u5546\u54C1\u5238"],[2,"\u5E97\u94FA\u901A\u7528\u5238"],[3,"\u5E97\u94FA\u5BA2\u670D\u4F53\u9A8C\u5238"]]);var j=(t=>(t[t.\u5168\u90E8=-1]="\u5168\u90E8",t[t.\u672A\u5F00\u59CB=0]="\u672A\u5F00\u59CB",t[t.\u8FDB\u884C\u4E2D=1]="\u8FDB\u884C\u4E2D",t[t.\u5DF2\u7ED3\u675F=2]="\u5DF2\u7ED3\u675F",t[t.\u5DF2\u4E0B\u7EBF=6]="\u5DF2\u4E0B\u7EBF",t))(j||{});const m=new Map([[-1,"\u5168\u90E8"],[0,"\u672A\u5F00\u59CB"],[1,"\u8FDB\u884C\u4E2D"],[2,"\u5DF2\u7ED3\u675F"],[6,"\u5DF2\u4E0B\u7EBF"]]),R=new Map([[-1,""],[0,"gray"],[1,"green"],[2,"blue"],[6,"red"]]),f=new Map([[1,"1\u5F20"],[2,"2\u5F20"],[3,"3\u5F20"],[4,"\u4E0D\u9650"]]),g={async list(t){return u.ZP.get("/merchant/coupons",t)},detail(t){return u.ZP.get("/merchant/coupons",{id:t})},delete(t){return u.ZP.delete("/merchant/coupons",{id:t})},create(t){return u.ZP.post("/merchant/coupons",t)},update(t){return u.ZP.patch("/merchant/coupons",t)}},y=(t=10)=>t<2,p=g}}]);
