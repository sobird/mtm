"use strict";(window.webpackJsonp_mtm_market=window.webpackJsonp_mtm_market||[]).push([[741],{3343:(N,C,t)=>{t.d(C,{Z:()=>U});var u=t(5893),i=t(599),g=t.n(i),a=t(4047),T=t.n(a),P=t(7484),M=t.n(P);const{RangePicker:A}=a.DatePicker,U=({text:d,mode:e,fieldProps:p,render:h,renderFormItem:_})=>{const{value:v=[],onChange:B,defaultValue:D}=p,m=[...v],[K,O]=m;O&&(m[1]=O?.map(n=>M()(n)));const[W,X]=(0,i.useState)(v[1]?2:1),[R,r]=(0,i.useState)(m);if(e==="read"){const n=(0,u.jsx)("span",{children:O?m[1].map(l=>l.format()).join(" \u5230 "):`\u9886\u53D6\u540E ${K||"-"} \u5929`});return h?h(d,{mode:e,...p},n):n}if(e==="edit"||e==="update"){const n=o=>{X(o.target.value),l(o.target.value,R)},l=(o,x)=>{const c=[...x||[]],[,f]=c;f&&(c[1]=f?.map(L=>L.format("YYYY-MM-DD"))),o===1?c[1]=void 0:c[0]=void 0,B?.(c)},E=(o,x)=>{const c=[...R||[]];c[o]=x===null?void 0:x,r(c),l(W,c)},s=(0,u.jsx)(a.Radio.Group,{value:W,onChange:n,children:(0,u.jsxs)(a.Space,{direction:"vertical",children:[(0,u.jsx)(a.Radio,{value:1,children:(0,u.jsxs)(a.Space,{children:[(0,u.jsx)("span",{children:"\u9886\u53D6\u540E"}),(0,u.jsx)(a.InputNumber,{addonAfter:"\u5929",min:1,max:30,value:R?.[0],defaultValue:D?.[0],onChange:o=>E(0,o)})]})}),(0,u.jsx)(a.Radio,{value:2,children:(0,u.jsxs)(a.Space,{children:[(0,u.jsx)("span",{children:"\u81EA\u5B9A\u4E49"}),(0,u.jsx)(A,{value:R?.[1],defaultValue:D?.[1],onChange:o=>E(1,o)})]})})]})});return _?_(d,{mode:e,...p},s):s}}},1849:(N,C,t)=>{t.d(C,{Z:()=>d});var u=t(5893),i=t(2975),g=t.n(i),a=t(4047),T=t.n(a),P=t(2979),M=t.n(P);const A=(0,i.createHashRouter)([{}]);function j(e,p,h,_){var v;let B=e.path;const D=h.indexOf(e)===h.length-1;return D?(0,u.jsx)("span",{children:e.title}):e.href?(0,u.jsx)("a",{href:A.createHref({pathname:e.href}),onClick:m=>{m.preventDefault(),A.navigate(e.href)},children:e.title}):(((v=e.path)==null?void 0:v.indexOf("/"))!==0&&(B="/"+_.filter(m=>m).join("/")),console.log("paths",JSON.stringify(_),B),D?(0,u.jsx)("span",{children:e.title}):(0,u.jsx)(i.Link,{to:B,relative:"route",children:e.title}))}const d=({children:e,breadcrumb:p,title:h,icon:_,description:v,extra:B,...D})=>(0,u.jsxs)("div",{className:"micro-page-container",...D,children:[(0,u.jsxs)("div",{className:"micro-page-header",children:[(0,u.jsx)(a.Breadcrumb,{className:"micro-breadcrumb",separator:(0,u.jsx)(P.RightOutlined,{}),itemRender:j,...p}),(0,u.jsxs)(a.Row,{className:"micro-page-header-heading",align:"middle",children:[(0,u.jsx)(a.Col,{flex:1,children:(0,u.jsxs)("h2",{children:[typeof _=="string"?(0,u.jsx)("i",{className:`iconfont icon-${_}`}):_,h]})}),(0,u.jsx)(a.Col,{children:(0,u.jsx)(a.Space,{children:B})})]}),v&&(0,u.jsx)("div",{className:"micro-page-header-description",children:v})]}),(0,u.jsx)(a.Card,{bodyStyle:{padding:16},className:"micor-page-content",children:e})]})},6785:(N,C,t)=>{t.d(C,{Z:()=>R});var u=t(5893),i=t(2975),g=t(4047),a=t(9018),T=t(6502);const P=(r,n)=>({fieldProps:E,proFieldProps:s,...o})=>(0,u.jsx)(T.Z,{valueType:n,render:(x,c,f)=>{const{mode:L}=c;return(0,u.jsx)(r,{text:x,mode:L,fieldProps:c})},renderFormItem:(x,c,f)=>{const{mode:L}=c;return(0,u.jsx)(r,{text:x,mode:L,fieldProps:c})},fieldProps:E,proFieldProps:s,...o});var M=t(599),A=t.n(M),j=t(869),U=t(2077),d=t.n(U);const e={delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"\u5343",million:"\u767E\u4E07",billion:"\u5341\u4EBF",trillion:"\u5146"},ordinal(){return"."},currency:{symbol:"\xA5"}};d().register("locale","zh",e),d().locale("zh"),d().nullFormat(""),d().fn.round=function(r=2){return Math.round(Math.pow(10,r)*this.value())/Math.pow(10,r)},d().fn.isFloat=function(){const r=this.value();return parseInt(r,10)<parseFloat(r)},d().register("format","custom formats",{regexps:{format:/(&)/,unformat:/(&)/},format(r,n,l){const E=d()._.includes(n," %")?" ":"";let s;return r*=100,n=n.replace(/\s?%/,""),s=d()._.numberToFormat(r,n,l),d()._.includes(s,")")?(s=s.split(""),s.splice(-1,0,`${E}%`),s=s.join("")):s=`${s}${E}%`,s},unformat(r){return d()._.stringToNumber(r)*.01}});const p=null,h=({text:r,mode:n,render:l,placeholder:E,renderFormItem:s,fieldProps:o},x)=>{const{value:c,defaultValue:f,onChange:L,id:z,validator:Y=[]}=o,[b,k]=(0,M.useState)([]),[y,V]=(0,j.Z)(()=>f,{value:c,onChange:L});if(n==="read"){const Z=(0,u.jsxs)("span",{ref:x,children:["\u6EE1 ",r[0]||"-","\u5143 \u51CF ",r[1]||"-","\u5143"]});return l?l(r,{mode:n,...o},Z):Z}if(n==="edit"||n==="update"){const Z=()=>{if(Array.isArray(y)){const[F,I]=y;typeof F=="number"&&typeof I=="number"&&F>I?V([I,F]):F===void 0&&I===void 0&&V(void 0)}},H=(F,I)=>{var w;const $=[...y||[]];$[F]=I===null?void 0:I,V($),b[F]={...(w=Y[F])==null?void 0:w.call(Y,$)},k(b)},S=o?.placeholder||E||["\u8BF7\u8F93\u5165\u6EE1\u51CF\u95E8\u69DB","\u8BF7\u8F93\u5165\u4F18\u60E0\u91D1\u989D"],J=F=>Array.isArray(S)?S[F]:S,{className:q,...G}=o,Q=(0,u.jsxs)(g.Space,{size:10,className:q,children:[(0,u.jsx)(g.InputNumber,{style:{width:"100%"},addonBefore:"\u6EE1",addonAfter:e.currency.symbol,min:0,max:5e3,...G,placeholder:J(0),id:`${z}-0`,value:y?.[0],defaultValue:f?.[0],onChange:F=>H(0,F)}),(0,u.jsx)(g.InputNumber,{style:{width:"100%"},addonBefore:"\u51CF",addonAfter:e.currency.symbol,min:0,max:5e3,...G,placeholder:J(1),id:`${z}-1`,value:y?.[1],defaultValue:f?.[1],onChange:F=>H(1,F)})]});return s?s(r,{mode:n,...o},Q):Q}return null},_=async(r,n)=>{const[l,E]=n;if(!l&&l!==0)throw new Error("\u8BF7\u8F93\u5165\u6EE1\u51CF\u95E8\u69DB");if(!E&&E!==0)throw new Error("\u8BF7\u8F93\u5165\u4F18\u60E0\u91D1\u989D")},v=[r=>{const[n,l]=r;if(!n&&n!==0)return{status:"error",help:"\u8BF7\u8F93\u5165\u6EE1\u51CF\u95E8\u69DB"}},r=>{const[n,l]=r;if(!l&&l!==0)return{status:"error",help:"\u8BF7\u8F93\u5165\u4F18\u60E0\u91D1\u989D"};if(l<.01)return{status:"error",help:"\u9762\u989D\u6700\u5C0F\u503C\u662F0.01\u5143"};if(n===0){if(l>500)return{status:"error",help:"\u95E8\u69DB\u4E3A0\u65F6\uFF0C\u9762\u989D\u9700\u5C0F\u4E8E\u7B49\u4E8E500\u5143"};l>10}}],B=A().forwardRef(h),D=P(B,"AmountRule");var m=t(3343);const K=P(m.Z,"UseTerm");var O=t(2655);const W={labelCol:{flex:"0 0 110px"}},R=({children:r,mode:n,...l})=>{const[,E]=(0,i.useSearchParams)();return(0,u.jsxs)(a.ProForm,{layout:"horizontal",...W,submitter:{render:(s,o)=>(0,u.jsx)(g.Space,{style:{marginLeft:110},children:o})},...l,children:[(0,u.jsx)(a.ProFormSelect,{name:"target",label:"\u4F18\u60E0\u5238\u7C7B\u578B",valueEnum:O.Qi,placeholder:"\u8BF7\u9009\u62E9",width:"lg",allowClear:!1,disabled:n&&n==="update",onChange:s=>{E(o=>(o.set("target",s),o),{replace:!0})}}),(0,u.jsx)(a.ProFormText,{width:"lg",name:"name",label:"\u4F18\u60E0\u5238\u540D\u79F0",placeholder:"\u8BF7\u586B\u5199\u4F18\u60E0\u5238\u540D\u79F0",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u4F18\u60E0\u5238\u540D\u79F0"},{max:10,message:"\u4F18\u60E0\u5238\u540D\u79F0\u6700\u591A\u586B\u519910\u4E2A\u5B57"}]}),(0,u.jsx)(a.ProFormText,{readonly:!0,width:"lg",name:"displayName",label:"\u4F18\u60E0\u5238\u6587\u6848"}),(0,u.jsx)(a.ProFormDateTimeRangePicker,{required:!0,width:"lg",name:"putTerm",label:"\u53D1\u653E\u65F6\u95F4",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u53D1\u653E\u65F6\u95F4"}]}),(0,u.jsx)(a.ProFormDigit,{label:"\u53D1\u653E\u5F20\u6570",name:"stock",placeholder:"\u8BF7\u8F93\u51651-1,000,000\u7684\u6B63\u6574\u6570",width:"lg",min:1,max:1e6,rules:[{required:!0,message:"\u8BF7\u586B\u5199\u53D1\u653E\u5F20\u6570"}]}),(0,u.jsx)(D,{fieldProps:{validator:v},placeholder:["\u8BF7\u8F93\u5165\u95E8\u69DB","\u8BF7\u8F93\u5165\u9762\u989D"],name:"rule",label:"\u95E8\u69DB\u53CA\u9762\u989D",width:"lg",rules:[{required:!0,message:"\u8BF7\u586B\u5199\u95E8\u69DB\u53CA\u9762\u989D"}]}),(0,u.jsx)(a.ProFormSelect,{name:"limit",label:"\u6BCF\u4EBA\u9650\u9886\u5F20\u6570",valueEnum:O.U8,placeholder:"\u8BF7\u9009\u62E9",width:"lg",rules:[{required:!0,message:"\u8BF7\u9009\u62E9\u6BCF\u4EBA\u9650\u9886\u5F20\u6570"}]}),(0,u.jsx)(K,{name:"useTerm",label:"\u4F7F\u7528\u65F6\u95F4",width:"lg",required:!0}),r]})}},8741:(N,C,t)=>{t.r(C),t.d(C,{default:()=>p});var u=t(5893),i=t(2975),g=t.n(i),a=t(4047),T=t.n(a),P=t(1849),M=t(6785),A=t(2655),j=t(599),U=t.n(j);const d=[{title:"\u9996\u9875",href:"/"},{title:"\u8425\u9500\u4E2D\u5FC3",path:"/"},{title:"\u4F18\u60E0\u5238",path:"coupons"},{title:"\u521B\u5EFA\u4F18\u60E0\u5238",path:"create"}],p=()=>{const h=(0,i.useNavigate)(),[_]=a.Form.useForm(),[v,B]=a.message.useMessage(),[D]=(0,i.useSearchParams)(),m=D.get("target"),K={target:Number(m)||1,displayName:"xx "+A.Xx[m]};(0,j.useEffect)(()=>{_.resetFields()},[m]);const O=async W=>{A.ZP.create(W).then(()=>{v.success("\u521B\u5EFA\u4F18\u60E0\u5238\u6210\u529F",1,()=>{h(-1)})})};return(0,u.jsxs)(P.Z,{breadcrumb:{items:d},title:"\u521B\u5EFA\u4F18\u60E0\u5238",extra:[(0,u.jsx)(a.Button,{onClick:()=>h(-1),children:"\u8FD4\u56DE"})],children:[B,(0,u.jsx)("div",{className:"coupon-create-page",children:(0,u.jsx)(M.Z,{form:_,initialValues:K,onFinish:O})})]})}},2655:(N,C,t)=>{t.d(C,{Qi:()=>a,Ry:()=>M,U8:()=>A,Wb:()=>i,Xx:()=>g,ZP:()=>d,jS:()=>P,mi:()=>U,mu:()=>T});var u=t(8892);const i=new Map([[0,"\u6EE1\u51CF\u5238"],[1,"\u6298\u6263\u5238"]]);var g=(e=>(e[e.\u5E97\u94FA\u5546\u54C1\u5238=1]="\u5E97\u94FA\u5546\u54C1\u5238",e[e.\u5E97\u94FA\u901A\u7528\u5238=2]="\u5E97\u94FA\u901A\u7528\u5238",e[e.\u5E97\u94FA\u5BA2\u670D\u4F53\u9A8C\u5238=3]="\u5E97\u94FA\u5BA2\u670D\u4F53\u9A8C\u5238",e))(g||{});const a=new Map([[1,"\u5E97\u94FA\u5546\u54C1\u5238"],[2,"\u5E97\u94FA\u901A\u7528\u5238"],[3,"\u5E97\u94FA\u5BA2\u670D\u4F53\u9A8C\u5238"]]);var T=(e=>(e[e.\u5168\u90E8=-1]="\u5168\u90E8",e[e.\u672A\u5F00\u59CB=0]="\u672A\u5F00\u59CB",e[e.\u8FDB\u884C\u4E2D=1]="\u8FDB\u884C\u4E2D",e[e.\u5DF2\u7ED3\u675F=2]="\u5DF2\u7ED3\u675F",e[e.\u5DF2\u4E0B\u7EBF=6]="\u5DF2\u4E0B\u7EBF",e))(T||{});const P=new Map([[-1,"\u5168\u90E8"],[0,"\u672A\u5F00\u59CB"],[1,"\u8FDB\u884C\u4E2D"],[2,"\u5DF2\u7ED3\u675F"],[6,"\u5DF2\u4E0B\u7EBF"]]),M=new Map([[-1,""],[0,"gray"],[1,"green"],[2,"blue"],[6,"red"]]),A=new Map([[1,"1\u5F20"],[2,"2\u5F20"],[3,"3\u5F20"],[4,"\u4E0D\u9650"]]),j={async list(e){return u.ZP.get("/merchant/coupons",e)},detail(e){return u.ZP.get("/merchant/coupons",{id:e})},delete(e){return u.ZP.delete("/merchant/coupons",{id:e})},create(e){return u.ZP.post("/merchant/coupons",e)},update(e){return u.ZP.patch("/merchant/coupons",e)}},U=(e=10)=>e<2,d=j}}]);
